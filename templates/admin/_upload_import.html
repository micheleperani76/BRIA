<!-- ============================================================
     ADMIN: Upload Multi-File e Import
     Versione: 1.0.0 | Data: 2026-02-13
     ============================================================ -->

<div class="row g-4">
    <!-- ===== UPLOAD MULTI-FILE ===== -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-cloud-upload"></i> Upload File
                <span class="badge bg-secondary ms-2" id="upload-total-badge" style="display:none;">0</span>
            </div>
            <div class="card-body">
                <!-- Zona Drag&amp;Drop -->
                <div id="drop-zone-multi" class="border border-2 border-dashed rounded p-4 text-center mb-3"
                     style="border-color: #dee2e6; background: #f8f9fa; cursor: pointer; transition: all 0.3s;">
                    <i class="bi bi-cloud-arrow-up" style="font-size: 3rem; color: #6c757d;"></i>
                    <p class="mb-1 mt-2"><strong>Trascina qui i file</strong></p>
                    <p class="text-muted small mb-0">PDF Creditsafe, Accounts CSV, Contacts CSV, Scadenze CSV</p>
                    <input type="file" id="file-input-multi" multiple accept=".pdf,.csv" style="display: none;">
                </div>

                <!-- Lista file classificati -->
                <div id="upload-list-multi" class="mb-3" style="display: none;">
                    <h6><i class="bi bi-files"></i> File da caricare:</h6>
                    <ul id="file-list-multi" class="list-group list-group-flush small"></ul>
                    <div id="upload-rejected-multi" class="mt-2" style="display:none;"></div>
                    <button id="upload-btn-multi" class="btn btn-success mt-2">
                        <i class="bi bi-upload"></i> Carica File
                    </button>
                </div>

                <!-- Risultato upload -->
                <div id="upload-result-multi" class="alert" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- ===== IMPORT CON PROGRESS MULTI-FASE ===== -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-play-circle"></i> Import Dati
            </div>
            <div class="card-body">
                <p class="text-muted small mb-2">
                    Ordine: 1&deg; Accounts &rarr; 2&deg; Scadenze &rarr; 3&deg; Contacts &rarr; 4&deg; PDF Creditsafe
                </p>

                <!-- File in attesa (caricato via JS) -->
                <div id="import-attesa" class="mb-3">
                    <div class="text-muted small"><i class="bi bi-hourglass-split"></i> Caricamento info...</div>
                </div>

                <!-- Tasto avvia -->
                <div id="import-idle-multi">
                    <button id="import-btn-multi" class="btn btn-primary" disabled>
                        <i class="bi bi-play-fill"></i> Avvia Import
                    </button>
                </div>

                <!-- Progress multi-fase -->
                <div id="import-progress-multi" style="display: none;">
                    <div class="mb-2">
                        <span class="badge bg-primary" id="progress-fase-badge">Fase 1/1</span>
                        <span id="progress-fase-label" class="ms-1 fw-bold"></span>
                    </div>
                    <div class="progress mb-2" style="height: 25px;">
                        <div id="progress-bar-multi" class="progress-bar progress-bar-striped progress-bar-animated"
                             role="progressbar" style="width: 0%;">0%</div>
                    </div>
                    <div class="small text-muted">
                        <i class="bi bi-file-earmark"></i> <span id="current-file-multi">-</span>
                    </div>
                    <!-- Fasi completate -->
                    <div id="fasi-completate" class="mt-2"></div>
                </div>

                <!-- Risultato import -->
                <div id="import-result-multi" style="display: none;"></div>
            </div>
        </div>
    </div>
</div>

<!-- ===== PROMEMORIA AGGIORNAMENTO CRM ===== -->
<div class="row g-4 mt-2">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span><i class="bi bi-bell"></i> Promemoria Aggiornamento CRM (ogni luned&igrave;)</span>
                <div class="form-check form-switch mb-0">
                    <input class="form-check-input" type="checkbox" id="toggle-promemoria-crm">
                    <label class="form-check-label small" for="toggle-promemoria-crm" id="toggle-promemoria-label">Caricamento...</label>
                </div>
            </div>
            <div class="card-body">
                <p class="text-muted small mb-2">
                    Ogni luned&igrave; mattina, gli utenti selezionati ricevono una notifica campanella:
                    <em>&quot;Aggiornare i dati CRM &mdash; scaricare da Zoho: Accounts_*.csv, Contacts_*.csv, Scadenze_*.csv&quot;</em>
                </p>
                <div id="crm-utenti-flags" class="row g-2">
                    <div class="text-muted small">Caricamento utenti...</div>
                </div>
            </div>
        </div>
    </div>
</div>
